% Term project, 2011 Jan Pokorny <xpokor04@stud.fit.vutbr.cz>

%============================================================================
% XELATEX-SPECIFIC PACKAGES

% XeLaTeX-specific packages and settings
\usepackage{ifxetex}
\ifxetex
    \usepackage{fontspec, xunicode}
    % Font settings
    %\usepackage{mathpazo}
    \setmainfont{TeX Gyre Pagella}

    %\defaultfontfeatures{Mapping=tex-text}
    %\setromanfont[Mapping=tex-text]{URW Palladio L}
    %\setsansfont[Scale=MatchLowercase,Mapping=tex-text]{URW Palladio L}
    \setmonofont[Scale=MatchLowercase]{DejaVu Sans Mono}

    % Language settings
    \usepackage{polyglossia}
    \ifCzech
        \setdefaultlanguage{czech}
        \setotherlanguage{english}
    \else
        \setdefaultlanguage{english}
        \setotherlanguage{czech}
    \fi
\else
    \typeout{Document intended to be processed exclusively with XeLaTeX!}
\fi


%============================================================================
% OTHER PACKAGES

% Additional symbols and mathematic stuff
%\usepackage{amsmath, amssymb}
\usepackage{textcomp}

% Priority packages
\usepackage{url}
\usepackage{color}
\usepackage{csquotes}

% Bibliography
%\usepackage[numbers]{natbib}
\usepackage[bibstyle=numeric
           ,citestyle=numeric-comp
           ,sorting=none
           ,backend=biber
           ]{biblatex}

% Other packages
\usepackage[xetex]{graphicx}
\usepackage{fancyvrb}
\usepackage{makeidx}
\usepackage{multicol}
\usepackage{enumitem}
\usepackage{listings}
\ifWis
    \ifxetex
        \definecolor{links}{rgb}{0.8,0.1,0.1}
        \definecolor{urls}{rgb}{0.1,0.1,0.8}
        \definecolor{cite}{rgb}{0.1,0.8,0.1}
        \usepackage[%backref=page,
                    % Bookmarks
                   ,bookmarksnumbered=true
                   ,bookmarksopenlevel=1
                   ,bookmarksopen=true
                   ,bookmarks=true
                    %
                   ,citecolor=cite
                   ,colorlinks=true
                    %
                   ,draft={\ifDraft{true}\else{false}\fi}
                    %
                   ,hyperindex=true
                   ,linkcolor=links
                   %,pagebackref=true
                   ,pdfborder={0 0 0}
                   ,pdfdisplaydoctitle=true
                   ,pdflang={\ifCzech{cs}\else{en}\fi}
                    % XeTeX backend
                   ,xetex
                   ,plainpages=false
                    % Connected with "Failed to convert input string to UTF16" message?
                    %unicode=true,
                   ,urlcolor=urls
                    % PDF metadata
                   ,pdftitle={\localizedDocInfo{title}}
                   ,pdfauthor={\fullDocAuthor}
                   ,pdfsubject={\localizedDocInfo{project}}
                   ,pdfkeywords={\localizedDocInfo{keywords}}
                   ]{hyperref}
        \def\UrlLeft{{\color{black}{<}}}
        \def\UrlRight{{\color{black}{>}}}
        \bgroup\catcode`\#=12\gdef\hash{#}\egroup \newcommand{\urlhash}[3]{\url{#1\hash#3}}
    \fi
\else
    \usepackage{backref}
    \def\UrlLeft{{<}}
    \def\UrlRight{{>}}
    \newcommand{\urlhash}[3]{\url{#1#2#3}}
\fi


%============================================================================
% PACKAGES-SPECIFIC CUSTOMIZATION


% Customization for `backref'
%\ifCzech
%    \renewcommand*\backref[1]{\ifx#1\relax \else (odkazuje s.\,#1) \fi}
%\else
%    \renewcommand*\backref[1]{\ifx#1\relax \else (referring p.\,#1) \fi}
%\fi

\makeindex

% \DeclareUrlCommand\url{\def\UrlLeft{<url:\ }\def\UrlRight{>}\urlstyle{tt}}
\DeclareUrlCommand\url{\def\UrlLeft{<}\def\UrlRight{>}\urlstyle{tt}}

\definecolor{lightgray}{rgb}{0.8,0.8,0.8}
\ifWis
    \definecolor{mygreen}{rgb}{0,0.6,0.1}
    \definecolor{mydarkgreen}{rgb}{0,0.3,0.05}
\else
    \definecolor{mygreen}{rgb}{0,0,0}
    \definecolor{mydarkgreen}{rgb}{0,0,0}
\fi

\setlength{\columnseprule}{0.333pt}

%
% Customization for `fancyvrb'
%

\newcounter{codecnt}
% \setcounter{codecnt}{0}
\renewcommand{\thecodecnt}{\thechapter{}.\arabic{codecnt}}

\ifWis
    \definecolor{code}{rgb}{0,0.6,0.4}
    \DefineVerbatimEnvironment%
        {code}{Verbatim}{
            commandchars=?\|$,
            fontsize=\small,
            formatcom=\color{code},
            %framerule=0.4pt,
            framesep=3mm,
            frame=topline,
            gobble=4,
            labelposition=topline,
            label={[\refstepcounter{codecnt}\label{code\arabic{chapter}.\arabic{codecnt}}\small{\textbf{Kód \thecodecnt}}%
                \ifx\codelabel\undefined \else \small{\textbf{:} \textit{\codelabel}} \fi]},
            numbersep=1.5mm,
            numbers=left,
            rulecolor=\color{black},
            xleftmargin=3.00mm,
        }
    \renewcommand{\theFancyVerbLine}{%
        \textcolor{black}{\tiny\arabic{FancyVerbLine}}
    }
    \def\lineRef#1#2{\hyperref[code:#1:#2]{\texttt{#2}}}
    % \def\lineRef#1#2{\normalsize{\texttt{\ref{code:#1:#2}}}}
\else
    \ifPrint
        \DefineVerbatimEnvironment%
            {code}{Verbatim}{
                commandchars=?\|$
                fontsize=\small,
                %framerule=0.4pt,
                framesep=3.00mm,
                frame=topline,
                gobble=4,
                labelposition=topline,
                label={[\refstepcounter{codecnt}\label{code\arabic{chapter}.\arabic{codecnt}}\small{\textbf{kód \thecodecnt}}%
                    \ifx\codelabel\undefined \else \small{\textbf{:} \textit{\codelabel}} \fi]},
                numbersep=1.5mm,
                numbers=left,
                xleftmargin=3.00mm,
            }
        \renewcommand{\theFancyVerbLine}{%
            {\tiny\arabic{FancyVerbLine}}
        }
        \def\lineRef#1#2{\texttt{\ref{code:#1:#2}}}
    \fi
\fi


%
% Customization for `enumitem'
%
\newlist{myitemize}{itemize}{40}
\setlist[myitemize]{label=\textbullet}


%%
%% Customization for `natbib'
%%
%\ifCzech
%    \bibliographystyle{csplainnat}
%\else
%%    \bibliographystyle{plain}
%    \bibliographystyle{alpha}
%\fi


%
% Customization for `csquotes'
%
\MakeOuterQuote{"}
\DeclareQuoteStyle{czech}{„}{“}{‚}{‘}


%
% Customization for bibliography
%
\ifCzech
    \renewcommand{\bibname}{Seznam použitých zdrojů}
\fi
\addbibresource{ref/references.bib}
